{% extends "layout.html" %}

{% block title %}
    แก้ไขโปรไฟล์
{% endblock %}

{% block content %}
<div class="flex justify-center">
    <form method="post" class="w-full max-w-xl" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="bg-white p-6 rounded shadow-md my-5">
            <!-- Profile Picture -->
            <div class="py-4 border-gray-200 grid grid-cols-6 items-center justify-center align-middle">
                <label for="file" class="col-span-1 justify-center items-center space-x-4">
                    <div class="relative">
                        {% if profiles.profile_image %}
                            <img id="profilePreview" class="w-16 h-16 object-cover object-center rounded-full border border-black" src="{{ profiles.profile_image.url }}" alt="Profile Image">
                        {% else %}
                            <img class="w-16 h-16 object-cover object-center rounded-full border border-black" src="https://as2.ftcdn.net/v2/jpg/05/65/22/41/1000_F_565224180_QNRiRQkf9Fw0dKRoZGwUknmmfk51SuSS.jpg" alt="Default Profile Image">
                        {% endif %}
                        <input id="file" type="file" name="profile_picture" class="hidden" accept="image/*" onchange="previewImage(event)">
                    </div>
                </label>
                <div class="col-span-1">
                    <button type="submit" name="save_profile_picture" class="text-xs font-medium text-blue-400">เปลี่ยนโปรไฟล์</button>
                </div>
            </div>

            <!-- Name Field -->
            <div class="border-t py-4 border-gray-200 grid grid-cols-6 items-center justify-center align-middle">
                <p class="col-span-1 text-xs font-semibold text-black">ชื่อ</p>
                <p id="name-text" class="col-span-3 text-xs font-medium text-gray-500">{{ profiles.username }}</p>
                <input id="name-input" name="user" class="col-span-5 text-xs font-medium text-gray-500 hidden border px-2 rounded-lg py-3 border-gray-200" type="text" value="{{ profiles.username }}">

                <div id="edit-name-btn" class="col-start-6 col-span-1 text-right">
                    <button type="button" onclick="toggleEdit('name')" class="text-xs font-medium text-blue-400">แก้ไข</button>
                </div>

                <div id="save-name-btn" class="hidden col-span-4 col-start-2 flex space-x-2 items-center my-2">
                    <div class="text-center border px-9 rounded-lg py-1 bg-blue-400">
                        <button type="submit" name="save_name" class="text-sm font-medium text-white px-2 py-1">บันทึก</button>
                    </div>
                    <div class="text-center border px-2 rounded-lg py-1 bg-gray-200">
                        <button type="button" onclick="cancelEdit('name')" class="text-sm font-medium text-black px-2 py-1">ยกเลิก</button>
                    </div>
                </div>
            </div>

            <!-- Email Field -->
            <div class="border-t py-4 border-gray-200 grid grid-cols-6 items-center justify-center align-middle">
                <p class="col-span-1 text-xs font-semibold text-black">อีเมล</p>
                <p id="email-text" class="col-span-3 text-xs font-medium text-gray-500">{{ profiles.email }}</p>
                <input id="email-input" name="email" class="col-span-5 text-xs font-medium text-gray-500 hidden border px-2 rounded-lg py-3 border-gray-200" type="email" value="{{ profiles.email }}">

                <div id="edit-email-btn" class="col-start-6 col-span-1 text-right">
                    <button type="button" onclick="toggleEdit('email')" class="text-xs font-medium text-blue-400">แก้ไข</button>
                </div>

                <div id="save-email-btn" class="hidden col-span-4 col-start-2 flex space-x-2 items-center my-2">
                    <div class="text-center border px-9 rounded-lg py-1 bg-blue-400">
                        <button type="submit" name="save_email" class="text-sm font-medium text-white px-2 py-1">บันทึก</button>
                    </div>
                    <div class="text-center border px-2 rounded-lg py-1 bg-gray-200">
                        <button type="button" onclick="cancelEdit('email')" class="text-sm font-medium text-black px-2 py-1">ยกเลิก</button>
                    </div>
                </div>
            </div>

            <!-- Phone Number Field -->
            <div class="border-t py-4 border-gray-200 grid grid-cols-6 items-center justify-center align-middle">
                <p class="col-span-1 text-xs font-semibold text-black">เบอร์โทรศัพท์</p>
                <p id="phone-text" class="col-span-3 text-xs font-medium text-gray-500">{{ profiles.phone }}</p>
                <input id="phone-input" name="phone_number" class="col-span-5 text-xs font-medium text-gray-500 hidden border px-2 rounded-lg py-3 border-gray-200" type="text" value="{{ profiles.phone }}">

                <div id="edit-phone-btn" class="col-start-6 col-span-1 text-right">
                    <button type="button" onclick="toggleEdit('phone')" class="text-xs font-medium text-blue-400">แก้ไข</button>
                </div>

                <div id="save-phone-btn" class="hidden col-span-4 col-start-2 flex space-x-2 items-center my-2">
                    <div class="text-center border px-9 rounded-lg py-1 bg-blue-400">
                        <button type="submit" name="save_phone" class="text-sm font-medium text-white px-2 py-1">บันทึก</button>
                    </div>
                    <div class="text-center border px-2 rounded-lg py-1 bg-gray-200">
                        <button type="button" onclick="cancelEdit('phone')" class="text-sm font-medium text-black px-2 py-1">ยกเลิก</button>
                    </div>
                </div>
            </div>

            <!-- About Me Field -->
            <div class="border-y py-4 border-gray-200 grid grid-cols-6 items-center justify-center align-middle">
                <p class="col-span-1 text-xs font-semibold text-black">เกี่ยวกับฉัน</p>

                <div id="edit-about-btn" class="col-start-6 col-span-1 text-right">
                    <button type="button" onclick="toggleEdit('about')" class="text-xs font-medium text-blue-400">แก้ไข</button>
                </div>

                <p id="about-text" class="mt-3 col-start-1 col-span-full text-xs font-medium text-gray-500">{{ profiles.about_me }}</p>

                <textarea id="about-input" name="about_me" class="mt-3 col-start-1 col-span-full text-xs font-medium text-gray-500 hidden border px-2 rounded-lg py-3 border-gray-200">{{ profiles.about_me }}</textarea>

                <div id="save-about-btn" class="hidden col-span-4 col-start-1 flex space-x-2 items-center my-2">
                    <div class="text-center border px-9 rounded-lg py-1 bg-blue-400">
                        <button type="submit" name="save_about_me" class="text-sm font-medium text-white px-2 py-1">บันทึก</button>
                    </div>
                    <div class="text-center border px-2 rounded-lg py-1 bg-gray-200">
                        <button type="button" onclick="cancelEdit('about')" class="text-sm font-medium text-black px-2 py-1">ยกเลิก</button>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <script>
        function toggleEdit(field) {
            document.getElementById(field + '-text').classList.add('hidden');
            document.getElementById(field + '-input').classList.remove('hidden');
            document.getElementById('edit-' + field + '-btn').classList.add('hidden');
            document.getElementById('save-' + field + '-btn').classList.remove('hidden');
        }

        function cancelEdit(field) {
            document.getElementById(field + '-input').classList.add('hidden');
            document.getElementById(field + '-text').classList.remove('hidden');
            document.getElementById('edit-' + field + '-btn').classList.remove('hidden');
            document.getElementById('save-' + field + '-btn').classList.add('hidden');
        }
    </script>
</div>
{% endblock %}
